"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[157],{"./src/js_modules/profile/Subscriptions/ButtonHandler.jsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_extends_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/extends.js"),_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),_chakra_ui_react__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@chakra-ui/button/dist/chunk-NAA7TEES.mjs"),next_translate_useTranslation__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/next-translate/lib/esm/useTranslation.js"),prop_types__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_9__),next_router__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/next/router.js"),_handlers__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/js_modules/profile/Subscriptions/handlers.jsx"),_utils_requests__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/utils/requests.js"),_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/utils/index.js"),_excluded=["subscription","onOpenUpgrade","setSubscriptionProps","onOpenCancelSubscription","children","allSubscriptions"],__jsx=react__WEBPACK_IMPORTED_MODULE_0__.createElement;function ButtonHandler(_ref){var _subscription$plans,_subscription$status,subscription=_ref.subscription,onOpenUpgrade=_ref.onOpenUpgrade,setSubscriptionProps=_ref.setSubscriptionProps,onOpenCancelSubscription=_ref.onOpenCancelSubscription,children=_ref.children,allSubscriptions=_ref.allSubscriptions,restStyles=(0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties_js__WEBPACK_IMPORTED_MODULE_6__.Z)(_ref,_excluded),t=(0,next_translate_useTranslation__WEBPACK_IMPORTED_MODULE_1__.Z)("profile").t,status=null==subscription?void 0:subscription.status,_useState=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),isLoading=_useState[0],setIsLoading=_useState[1],router=(0,next_router__WEBPACK_IMPORTED_MODULE_2__.useRouter)(),planSlug=null==subscription||null===(_subscription$plans=subscription.plans)||void 0===_subscription$plans||null===(_subscription$plans=_subscription$plans[0])||void 0===_subscription$plans?void 0:_subscription$plans.slug,isPlanFinancingExpired="plan_financing"===(null==subscription?void 0:subscription.type)&&(null==subscription?void 0:subscription.valid_until)<(new Date).toISOString(),planOfferedAcquired=null==allSubscriptions?void 0:allSubscriptions.some((function(sub){return sub.plans.some((function(plan){var _subscription$planOff;return plan.slug===(null==subscription||null===(_subscription$planOff=subscription.planOffer)||void 0===_subscription$planOff?void 0:_subscription$planOff.slug)}))})),isFreeTrial="FREE_TRIAL"===status,isActive="ACTIVE"===status,isFullyPaid="fully_paid"===(null==subscription||null===(_subscription$status=subscription.status)||void 0===_subscription$status?void 0:_subscription$status.toLowerCase()),isError="ERROR"===status,isCancelled="CANCELLED"===status,isExpired="EXPIRED"===status,isPaymentIssue="PAYMENT_ISSUE"===status,_profileHandlers=(0,_handlers__WEBPACK_IMPORTED_MODULE_3__.Z)({}),getPlanOffer=_profileHandlers.getPlanOffer,reactivatePlan=_profileHandlers.reactivatePlan,handlePlanOffer=function handlePlanOffer(){setIsLoading(!0),getPlanOffer({slug:planSlug,onOpenUpgrade}).finally((function(){return setIsLoading(!1)}))},manageActionBasedOnLocation=function manageActionBasedOnLocation(){"/profile/[slug]"!==router.pathname?router.push("/profile/subscriptions"):(0,_utils_requests__WEBPACK_IMPORTED_MODULE_4__._1)({dataLayer:{event:"chat_with_support",plan:planSlug,agent:(0,_utils__WEBPACK_IMPORTED_MODULE_5__.S7)()}})},buttonProps=function getStyles(){return planOfferedAcquired&&(isFreeTrial||isFullyPaid)||planOfferedAcquired&&isActive?{text:"",style:{display:"none"}}:isFreeTrial||"plan_financing"!==(null==subscription?void 0:subscription.type)&&(isActive||isFullyPaid)&&null!=subscription&&subscription.planOffer.slug?{text:t("subscription.upgrade"),style:{variant:"outline",color:"blue.default",borderColor:"currentColor",fontWeight:700}}:"plan_financing"!==(null==subscription?void 0:subscription.type)&&(isActive||isFullyPaid)?{text:t("subscription.cancel"),style:{variant:"link"}}:isCancelled?{text:t("subscription.reactivate-subscription"),style:{variant:"default",color:"white",fontWeight:500}}:!(isPaymentIssue||isError||isExpired)||null!=subscription&&subscription.planOffer.slug?{text:"",style:{display:"none"}}:{text:t("subscription.contact-support"),isComponent:!0,component:__jsx(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_7__.z,{onClick:manageActionBasedOnLocation,marginTop:"5px",textAlign:"center",userSelect:"none",justifyContent:"center",fontSize:"sm",fontWeight:700,color:"blue.1000",width:"100%",_hover:"none",_active:"none",background:"auto",height:"none"},"/profile/[slug]"===router.pathname?t("subscription.contact-support"):t("subscription.manage-subscription"))}}();return __jsx(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,!isFullyPaid&&buttonProps.isComponent&&__jsx(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,null==buttonProps?void 0:buttonProps.component),!isFullyPaid&&!buttonProps.isComponent&&__jsx(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_7__.z,(0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_extends_js__WEBPACK_IMPORTED_MODULE_8__.Z)({isLoading,onClick:function onClick(){isPlanFinancingExpired&&handlePlanOffer(),(["FREE_TRIAL","PAYMENT_ISSUE"].includes(status)||["ACTIVE","FULLY_PAID"].includes(status)&&null!=subscription&&subscription.planOffer.slug)&&handlePlanOffer(),!["ACTIVE","FULLY_PAID"].includes(status)||"plan_financing"===(null==subscription?void 0:subscription.type)||null!=subscription&&subscription.planOffer.slug||onOpenCancelSubscription(),["CANCELLED"].includes(status)&&function handleReactivatePlan(){setIsLoading(!0),reactivatePlan(planSlug,status)}(),setSubscriptionProps(subscription)},color:"blue.default",margin:"auto 0 0 0"},buttonProps.style,restStyles),children||buttonProps.text))}ButtonHandler.propTypes={subscription:prop_types__WEBPACK_IMPORTED_MODULE_9___default().objectOf(prop_types__WEBPACK_IMPORTED_MODULE_9___default().oneOfType([prop_types__WEBPACK_IMPORTED_MODULE_9___default().any])),onOpenUpgrade:prop_types__WEBPACK_IMPORTED_MODULE_9___default().func,setSubscriptionProps:prop_types__WEBPACK_IMPORTED_MODULE_9___default().func,onOpenCancelSubscription:prop_types__WEBPACK_IMPORTED_MODULE_9___default().func,restStyles:prop_types__WEBPACK_IMPORTED_MODULE_9___default().objectOf(prop_types__WEBPACK_IMPORTED_MODULE_9___default().oneOfType([prop_types__WEBPACK_IMPORTED_MODULE_9___default().any])),children:prop_types__WEBPACK_IMPORTED_MODULE_9___default().node,allSubscriptions:prop_types__WEBPACK_IMPORTED_MODULE_9___default().arrayOf(prop_types__WEBPACK_IMPORTED_MODULE_9___default().objectOf([prop_types__WEBPACK_IMPORTED_MODULE_9___default().any]))},ButtonHandler.defaultProps={subscription:{},onOpenUpgrade:function onOpenUpgrade(){},setSubscriptionProps:function setSubscriptionProps(){},onOpenCancelSubscription:function onOpenCancelSubscription(){},restStyles:{},children:null,allSubscriptions:[]},ButtonHandler.__docgenInfo={description:"",methods:[],displayName:"ButtonHandler",props:{subscription:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"objectOf",value:{name:"union",value:[{name:"any"}]}},required:!1},onOpenUpgrade:{defaultValue:{value:"() => { }",computed:!1},description:"",type:{name:"func"},required:!1},setSubscriptionProps:{defaultValue:{value:"() => { }",computed:!1},description:"",type:{name:"func"},required:!1},onOpenCancelSubscription:{defaultValue:{value:"() => { }",computed:!1},description:"",type:{name:"func"},required:!1},restStyles:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"objectOf",value:{name:"union",value:[{name:"any"}]}},required:!1},children:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"node"},required:!1},allSubscriptions:{defaultValue:{value:"[]",computed:!1},description:"",type:{name:"arrayOf",value:{name:"objectOf",value:{name:"custom",raw:"[PropTypes.any]"}}},required:!1}}};const __WEBPACK_DEFAULT_EXPORT__=ButtonHandler},"./src/js_modules/profile/Subscriptions/handlers.jsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),_home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),_home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0__),_chakra_ui_react__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@chakra-ui/toast/dist/chunk-ENIANY67.mjs"),next_translate_useTranslation__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/next-translate/lib/esm/useTranslation.js"),next_router__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/next/router.js"),prop_types__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_14__),date_fns__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/date-fns/esm/format/index.js"),date_fns_locale__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/date-fns/esm/locale/en-US/index.js"),date_fns_locale__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/date-fns/esm/locale/es/index.js"),_common_hooks_useStyle__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/common/hooks/useStyle.js"),_common_services_breathecode__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/common/services/breathecode.js"),_common_store_actions_signupAction__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/common/store/actions/signupAction.js"),_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/utils/index.js"),_utils_variables__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/utils/variables.js");function profileHandlers(){var _useTranslation=(0,next_translate_useTranslation__WEBPACK_IMPORTED_MODULE_1__.Z)("profile"),t=_useTranslation.t,lang=_useTranslation.lang,_useStyle=(0,_common_hooks_useStyle__WEBPACK_IMPORTED_MODULE_7__.Z)(),reverseFontColor=_useStyle.reverseFontColor,fontColor=_useStyle.fontColor,lightColor=_useStyle.lightColor,toast=(0,_chakra_ui_react__WEBPACK_IMPORTED_MODULE_8__.p)(),router=(0,next_router__WEBPACK_IMPORTED_MODULE_2__.useRouter)(),setPaymentStatus=(0,_common_store_actions_signupAction__WEBPACK_IMPORTED_MODULE_4__.Z)().setPaymentStatus,getPlanProps=function(){var _ref=(0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_9__.Z)(_home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark((function _callee(slug){var resp,data;return _home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,_common_services_breathecode__WEBPACK_IMPORTED_MODULE_3__.Z.payment().getPlanProps(encodeURIComponent(slug));case 2:return resp=_context.sent,_context.next=5,null==resp?void 0:resp.data;case 5:return data=_context.sent,_context.abrupt("return",data);case 7:case"end":return _context.stop()}}),_callee)})));return function getPlanProps(_x){return _ref.apply(this,arguments)}}(),formatDate=function formatDate(date){if(!date)return"N/A";var parsedDate=new Date(date);return(0,date_fns__WEBPACK_IMPORTED_MODULE_10__.Z)(parsedDate,"dd MMM yy",{locale:"en"===lang||"us"===lang?date_fns_locale__WEBPACK_IMPORTED_MODULE_11__.Z:date_fns_locale__WEBPACK_IMPORTED_MODULE_12__.Z})};return{statusStyles:{free_trial:{color:fontColor,border:"1px solid",borderColor:lightColor},fully_paid:{color:"green.400",background:"green.light"},active:{color:"green.400",background:"green.light"},expired:{color:fontColor,background:"transparent",border:"1px solid"},error:{color:fontColor,background:"transparent",border:"1px solid"},payment_issue:{color:"danger",background:"red.light"},cancelled:{color:reverseFontColor,background:"gray.default"},completed:{color:"blue.default",border:"1px solid",borderColor:"blue.default"}},statusLabel:{free_trial:t("subscription.status.free_trial"),fully_paid:t("subscription.status.fully_paid"),active:t("subscription.status.active"),expired:t("subscription.status.expired"),payment_issue:t("subscription.status.payment_issue"),cancelled:t("subscription.status.cancelled"),completed:t("subscription.status.completed"),error:t("subscription.status.error")},getLocaleDate:function getLocaleDate(date){return new Date(date).toLocaleDateString()},durationFormated:function durationFormated(DurFormat){var duration=null==DurFormat?void 0:DurFormat.duration,days=null==duration?void 0:duration.days,hours=null==duration?void 0:duration.hours,daysLabel=t("days"),dayLabel=t("day"),monthsLabel=t("months"),monthLabel=t("month"),andLabel=t("and"),hoursLabel=t("hours");return"expired"===DurFormat.status?t("expired"):(null==duration?void 0:duration.months)>0?"".concat(null==duration?void 0:duration.months," ").concat((null==duration?void 0:duration.months)<=1?monthLabel:monthsLabel):0===days&&hours>0?"".concat(hours,"h ").concat(andLabel," ").concat(null==duration?void 0:duration.minutes,"min"):days>7?"".concat(days," ").concat(daysLabel):days<=7&&hours<0?"".concat(days," ").concat(days>1?daysLabel:dayLabel," ").concat((null==duration?void 0:duration.hours)>0?"".concat(andLabel," ").concat(null==duration?void 0:duration.hours," ").concat(hoursLabel):""):null==DurFormat?void 0:DurFormat.formated},payUnitString:function payUnitString(payUnit){return"MONTH"===payUnit?t("monthly"):"HALF"===payUnit?t("half-year"):"QUARTER"===payUnit?t("quarterly"):"YEAR"===payUnit?t("yearly"):payUnit},getPlan:function getPlan(_ref2){var slug=_ref2.slug,_ref2$onOpenUpgrade=_ref2.onOpenUpgrade,onOpenUpgrade=void 0===_ref2$onOpenUpgrade?function(){}:_ref2$onOpenUpgrade,_ref2$disableRedirect=_ref2.disableRedirects,disableRedirects=void 0!==_ref2$disableRedirect&&_ref2$disableRedirect;return new Promise((function(resolve,reject){_common_services_breathecode__WEBPACK_IMPORTED_MODULE_3__.Z.payment().getPlan(encodeURIComponent(slug)).then(function(){var _ref3=(0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_9__.Z)(_home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark((function _callee2(res){var data,bullets,outOfConsumables,_planData$financing_o,_planData$financing_o2,_planData$financing_o3,planData,existsAmountPerHalf,existsAmountPerMonth,existsAmountPerQuarter,existsAmountPerYear,isNotTrial,financingOptionsExists,financingOptionsManyMonthsExists,financingOptionsOnePaymentExists,isTotallyFree,financingOptionsManyMonths,financingOptionsOnePayment,getTrialLabel,onePaymentFinancing,trialPlan,monthPlan,yearPlan,financingOption,paymentList,financingList,finalData;return _home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return data=null==res?void 0:res.data,_context2.next=3,getPlanProps(slug);case 3:bullets=_context2.sent,outOfConsumables=null==data?void 0:data.service_items.some((function(item){return 0===(null==item?void 0:item.how_many)})),data&&null!=data&&data.slug?(planData=data,existsAmountPerHalf=(null==data?void 0:data.amount_per_half)>0||(null==data?void 0:data.price_per_half)>0,existsAmountPerMonth=(null==data?void 0:data.amount_per_month)>0||(null==data?void 0:data.price_per_month)>0,existsAmountPerQuarter=(null==data?void 0:data.amount_per_quarter)>0||(null==data?void 0:data.price_per_quarter)>0,existsAmountPerYear=(null==data?void 0:data.amount_per_year)>0||(null==data?void 0:data.price_per_year)>0,isNotTrial=existsAmountPerHalf||existsAmountPerMonth||existsAmountPerQuarter||existsAmountPerYear,financingOptionsExists=(null==planData||null===(_planData$financing_o=planData.financing_options)||void 0===_planData$financing_o?void 0:_planData$financing_o.length)>0,financingOptionsManyMonthsExists=financingOptionsExists&&(null==planData||null===(_planData$financing_o2=planData.financing_options)||void 0===_planData$financing_o2?void 0:_planData$financing_o2.some((function(l){return(null==l?void 0:l.monthly_price)>0&&(null==l?void 0:l.how_many_months)>1}))),financingOptionsOnePaymentExists=financingOptionsExists&&(null==planData||null===(_planData$financing_o3=planData.financing_options)||void 0===_planData$financing_o3?void 0:_planData$financing_o3.some((function(l){return(null==l?void 0:l.monthly_price)>0&&1===(null==l?void 0:l.how_many_months)}))),isTotallyFree=!isNotTrial&&0===(null==planData?void 0:planData.trial_duration)&&!financingOptionsExists,financingOptionsManyMonths=financingOptionsManyMonthsExists?null==planData?void 0:planData.financing_options.filter((function(l){return(null==l?void 0:l.monthly_price)>0&&(null==l?void 0:l.how_many_months)>1})).sort((function(a,b){return(null==a?void 0:a.monthly_price)-(null==b?void 0:b.monthly_price)})):[],financingOptionsOnePayment=financingOptionsOnePaymentExists?null==planData?void 0:planData.financing_options.filter((function(l){return(null==l?void 0:l.monthly_price)>0&&1===(null==l?void 0:l.how_many_months)})).sort((function(a,b){return(null==a?void 0:a.monthly_price)-(null==b?void 0:b.monthly_price)})):[],getTrialLabel=function getTrialLabel(){if(isTotallyFree)return{priceText:t("subscription.upgrade-modal.free-course"),description:t("subscription.upgrade-modal.full_access")};if("WEEK"===(null==planData?void 0:planData.trial_duration_unit)){var weekDays=7*(null==planData?void 0:planData.trial_duration);return{priceText:"".concat(t("subscription.upgrade-modal.duration_days",{duration:weekDays})," ").concat(t("subscription.upgrade-modal.connector_duration_trial")),description:"".concat(t("subscription.upgrade-modal.no_card_needed")," ").concat(t("subscription.upgrade-modal.duration_days",{duration:weekDays}))}}return"DAY"===(null==planData?void 0:planData.trial_duration_unit)?{priceText:"".concat(t("subscription.upgrade-modal.duration_days",{duration:null==planData?void 0:planData.trial_duration})," ").concat(t("subscription.upgrade-modal.connector_duration_trial")),description:"".concat(t("subscription.upgrade-modal.no_card_needed")," ").concat(t("subscription.upgrade-modal.duration_days",{duration:null==planData?void 0:planData.trial_duration}))}:"MONTH"===(null==planData?void 0:planData.trial_duration_unit)?{priceText:"".concat(null==planData?void 0:planData.trial_duration," month trial"),description:"".concat(t("subscription.upgrade-modal.no_card_needed")," ").concat(t("subscription.upgrade-modal.duration_month",{duration:null==planData?void 0:planData.trial_duration}))}:{priceText:t("subscription.upgrade-modal.free_trial"),description:""}},onePaymentFinancing=financingOptionsOnePaymentExists?financingOptionsOnePayment.map((function(item){return{title:t("subscription.upgrade-modal.one_payment"),price:null==item?void 0:item.monthly_price,priceText:"$".concat(null==item?void 0:item.monthly_price),period:"FINANCING",description:t("subscription.upgrade-modal.full_access"),plan_id:"f-".concat(null==item?void 0:item.monthly_price,"-").concat(null==item?void 0:item.how_many_months),how_many_months:null==item?void 0:item.how_many_months,suggested_plan:planData,type:"PAYMENT",show:!0}})):[],trialPlan=financingOptionsExists||isNotTrial?{}:{title:t("subscription.upgrade-modal.free_trial"),price:0,priceText:getTrialLabel().priceText,trialDuration:null==planData?void 0:planData.trial_duration,period:null==planData?void 0:planData.trial_duration_unit,description:getTrialLabel().description,plan_id:"p-".concat(null==planData?void 0:planData.trial_duration,"-trial"),suggested_plan:planData,type:isTotallyFree?"FREE":"TRIAL",isFreeTier:!0,show:!0},monthPlan=!financingOptionsOnePaymentExists&&existsAmountPerMonth?[{title:t("subscription.upgrade-modal.monthly_payment"),price:null==planData?void 0:planData.price_per_month,priceText:"$".concat(null==planData?void 0:planData.price_per_month),period:"MONTH",description:t("subscription.upgrade-modal.full_access"),plan_id:"p-".concat(null==planData?void 0:planData.price_per_month),suggested_plan:planData,type:"PAYMENT",show:!0}]:onePaymentFinancing,yearPlan=existsAmountPerYear?{title:t("subscription.upgrade-modal.yearly_payment"),price:null==planData?void 0:planData.price_per_year,priceText:"$".concat(null==planData?void 0:planData.price_per_year),period:"YEAR",description:t("subscription.upgrade-modal.full_access"),plan_id:"p-".concat(null==planData?void 0:planData.price_per_year),suggested_plan:planData,type:"PAYMENT",show:!0}:{},financingOption=financingOptionsManyMonthsExists?financingOptionsManyMonths.map((function(item){return{title:t("subscription.upgrade-modal.many_months_payment",{qty:null==item?void 0:item.how_many_months}),price:null==item?void 0:item.monthly_price,priceText:"$".concat(null==item?void 0:item.monthly_price," x ").concat(null==item?void 0:item.how_many_months),period:"FINANCING",description:t("subscription.upgrade-modal.many_months_description",{monthly_price:null==item?void 0:item.monthly_price,many_months:null==item?void 0:item.how_many_months}),plan_id:"f-".concat(null==item?void 0:item.monthly_price,"-").concat(null==item?void 0:item.how_many_months),how_many_months:null==item?void 0:item.how_many_months,suggested_plan:planData,type:"PAYMENT",show:!0}})):[],paymentList=[].concat((0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_13__.Z)(monthPlan),[yearPlan,trialPlan]).filter((function(plan){return Object.keys(plan).length>0})),financingList=null==financingOption?void 0:financingOption.filter((function(plan){return Object.keys(plan).length>0})),finalData={title:(0,_utils__WEBPACK_IMPORTED_MODULE_5__.fp)((0,_utils__WEBPACK_IMPORTED_MODULE_5__.A$)(String(null==planData?void 0:planData.slug))),slug:null==planData?void 0:planData.slug,isTotallyFree,details:null==planData?void 0:planData.details,expires_at:null==planData?void 0:planData.expires_at,pricing_exists:isNotTrial||financingOptionsExists,paymentOptions:paymentList,financingOptions:financingList,outOfConsumables,consumableOptions:[],bullets},resolve(finalData),null!=data&&data.show_modal&&!disableRedirects&&onOpenUpgrade(finalData),!1===(null==data?void 0:data.show_modal)&&planData&&!disableRedirects&&router.push("/checkout?plan=".concat(null==planData?void 0:planData.slug))):(toast({position:"top",title:t("alert-message:error-getting-plan"),status:"error",duration:5e3,isClosable:!0}),resolve({}));case 6:case"end":return _context2.stop()}}),_callee2)})));return function(_x2){return _ref3.apply(this,arguments)}}()).catch((function(){reject(),toast({position:"top",title:t("alert-message:error-getting-plan"),status:"error",duration:5e3,isClosable:!0})}))}))},getPlanOffer:function getPlanOffer(_ref4){var slug=_ref4.slug,_ref4$onOpenUpgrade=_ref4.onOpenUpgrade,onOpenUpgrade=void 0===_ref4$onOpenUpgrade?function(){}:_ref4$onOpenUpgrade,_ref4$disableRedirect=_ref4.disableRedirects,disableRedirects=void 0!==_ref4$disableRedirect&&_ref4$disableRedirect,_ref4$withCurrentPlan=_ref4.withCurrentPlan,withCurrentPlan=void 0!==_ref4$withCurrentPlan&&_ref4$withCurrentPlan;return new Promise((function(resolve,reject){_common_services_breathecode__WEBPACK_IMPORTED_MODULE_3__.Z.payment({original_plan:slug}).planOffer().then(function(){var _ref5=(0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_9__.Z)(_home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark((function _callee3(res){var data,currentOffer,currentSuggestedPlan,_currentOffer$origina,_offerData$financing_,_offerData$financing_2,_offerData$financing_3,offerData,bullets,outOfConsumables,existsAmountPerHalf,existsAmountPerMonth,existsAmountPerQuarter,existsAmountPerYear,isNotTrial,financingOptionsExists,financingOptionsManyMonthsExists,financingOptionsOnePaymentExists,_isTotallyFree,financingOptionsManyMonths,financingOptionsOnePayment,getTrialLabel,onePaymentFinancing,trialPlan,monthPlan,yearPlan,financingOption,paymentList,financingList,finalData;return _home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(data=null==res?void 0:res.data,currentOffer=data.find((function(item){var _item$original_plan;return(null==item||null===(_item$original_plan=item.original_plan)||void 0===_item$original_plan?void 0:_item$original_plan.slug)===slug})),currentSuggestedPlan=withCurrentPlan?null==currentOffer?void 0:currentOffer.original_plan:null==currentOffer?void 0:currentOffer.suggested_plan,!currentOffer||null==currentSuggestedPlan||!currentSuggestedPlan.slug){_context3.next=34;break}return offerData=currentSuggestedPlan,_context3.next=7,getPlanProps(null==offerData?void 0:offerData.slug);case 7:bullets=_context3.sent,outOfConsumables=null==currentOffer||null===(_currentOffer$origina=currentOffer.original_plan)||void 0===_currentOffer$origina?void 0:_currentOffer$origina.service_items.some((function(item){return 0===(null==item?void 0:item.how_many)})),existsAmountPerHalf=(null==offerData?void 0:offerData.price_per_half)>0,existsAmountPerMonth=(null==offerData?void 0:offerData.price_per_month)>0,existsAmountPerQuarter=(null==offerData?void 0:offerData.price_per_quarter)>0,existsAmountPerYear=(null==offerData?void 0:offerData.price_per_year)>0,isNotTrial=existsAmountPerHalf||existsAmountPerMonth||existsAmountPerQuarter||existsAmountPerYear,financingOptionsExists=(null==offerData||null===(_offerData$financing_=offerData.financing_options)||void 0===_offerData$financing_?void 0:_offerData$financing_.length)>0,financingOptionsManyMonthsExists=financingOptionsExists&&(null==offerData||null===(_offerData$financing_2=offerData.financing_options)||void 0===_offerData$financing_2?void 0:_offerData$financing_2.some((function(l){return(null==l?void 0:l.monthly_price)>0&&(null==l?void 0:l.how_many_months)>1}))),financingOptionsOnePaymentExists=financingOptionsExists&&(null==offerData||null===(_offerData$financing_3=offerData.financing_options)||void 0===_offerData$financing_3?void 0:_offerData$financing_3.some((function(l){return(null==l?void 0:l.monthly_price)>0&&1===(null==l?void 0:l.how_many_months)}))),_isTotallyFree=!isNotTrial&&0===(null==offerData?void 0:offerData.trial_duration)&&!financingOptionsExists,financingOptionsManyMonths=financingOptionsManyMonthsExists?null==offerData?void 0:offerData.financing_options.filter((function(l){return(null==l?void 0:l.monthly_price)>0&&(null==l?void 0:l.how_many_months)>1})).sort((function(a,b){return(null==a?void 0:a.monthly_price)-(null==b?void 0:b.monthly_price)})):[],financingOptionsOnePayment=financingOptionsOnePaymentExists?null==offerData?void 0:offerData.financing_options.filter((function(l){return(null==l?void 0:l.monthly_price)>0&&1===(null==l?void 0:l.how_many_months)})).sort((function(a,b){return(null==a?void 0:a.monthly_price)-(null==b?void 0:b.monthly_price)})):[],getTrialLabel=function getTrialLabel(){if(_isTotallyFree)return{priceText:t("subscription.upgrade-modal.free-course"),description:t("subscription.upgrade-modal.full_access")};if("WEEK"===(null==offerData?void 0:offerData.trial_duration_unit)){var weekDays=7*(null==offerData?void 0:offerData.trial_duration);return{priceText:"".concat(t("subscription.upgrade-modal.duration_days",{duration:weekDays})," ").concat(t("subscription.upgrade-modal.connector_duration_trial")),description:"".concat(t("subscription.upgrade-modal.no_card_needed")," ").concat(t("subscription.upgrade-modal.duration_days",{duration:weekDays}))}}return"DAY"===(null==offerData?void 0:offerData.trial_duration_unit)?{priceText:"".concat(t("subscription.upgrade-modal.duration_days",{duration:null==offerData?void 0:offerData.trial_duration})," ").concat(t("subscription.upgrade-modal.connector_duration_trial")),description:"".concat(t("subscription.upgrade-modal.no_card_needed")," ").concat(t("subscription.upgrade-modal.duration_days",{duration:null==offerData?void 0:offerData.trial_duration}))}:"MONTH"===(null==offerData?void 0:offerData.trial_duration_unit)?{priceText:"".concat(null==offerData?void 0:offerData.trial_duration," month trial"),description:"".concat(t("subscription.upgrade-modal.no_card_needed")," ").concat(t("subscription.upgrade-modal.duration_month",{duration:null==offerData?void 0:offerData.trial_duration}))}:{priceText:t("subscription.upgrade-modal.free_trial"),description:""}},onePaymentFinancing=financingOptionsOnePaymentExists?financingOptionsOnePayment.map((function(item){return{title:t("subscription.upgrade-modal.one_payment"),price:null==item?void 0:item.monthly_price,priceText:"$".concat(null==item?void 0:item.monthly_price),period:"FINANCING",description:t("subscription.upgrade-modal.full_access"),plan_id:"f-".concat(null==item?void 0:item.monthly_price,"-").concat(null==item?void 0:item.how_many_months),how_many_months:null==item?void 0:item.how_many_months,suggested_plan:offerData,type:"PAYMENT",show:!0}})):[],trialPlan=financingOptionsExists||isNotTrial?{}:{title:t("subscription.upgrade-modal.free_trial"),price:0,priceText:getTrialLabel().priceText,trialDuration:null==offerData?void 0:offerData.trial_duration,period:null==offerData?void 0:offerData.trial_duration_unit,description:getTrialLabel().description,plan_id:"p-".concat(null==offerData?void 0:offerData.trial_duration,"-trial"),suggested_plan:offerData,type:_isTotallyFree?"FREE":"TRIAL",isFreeTier:!0,show:!0},monthPlan=!financingOptionsOnePaymentExists&&existsAmountPerMonth?[{title:t("subscription.upgrade-modal.monthly_payment"),price:null==offerData?void 0:offerData.price_per_month,priceText:"$".concat(null==offerData?void 0:offerData.price_per_month),period:"MONTH",description:t("subscription.upgrade-modal.full_access"),plan_id:"p-".concat(null==offerData?void 0:offerData.price_per_month),suggested_plan:offerData,type:"PAYMENT",show:!0}]:onePaymentFinancing,yearPlan=existsAmountPerYear?{title:t("subscription.upgrade-modal.yearly_payment"),price:null==offerData?void 0:offerData.price_per_year,priceText:"$".concat(null==offerData?void 0:offerData.price_per_year),period:"YEAR",description:t("subscription.upgrade-modal.full_access"),plan_id:"p-".concat(null==offerData?void 0:offerData.price_per_year),suggested_plan:offerData,type:"PAYMENT",show:!0}:{},financingOption=financingOptionsManyMonthsExists?financingOptionsManyMonths.map((function(item){return{title:t("subscription.upgrade-modal.many_months_payment",{qty:null==item?void 0:item.how_many_months}),price:null==item?void 0:item.monthly_price,priceText:"$".concat(null==item?void 0:item.monthly_price," x ").concat(null==item?void 0:item.how_many_months),period:"FINANCING",description:t("subscription.upgrade-modal.many_months_description",{monthly_price:null==item?void 0:item.monthly_price,many_months:null==item?void 0:item.how_many_months}),plan_id:"f-".concat(null==item?void 0:item.monthly_price,"-").concat(null==item?void 0:item.how_many_months),how_many_months:null==item?void 0:item.how_many_months,suggested_plan:offerData,type:"PAYMENT",show:!0}})):[],paymentList=[].concat((0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_13__.Z)(monthPlan),[yearPlan,trialPlan]).filter((function(plan){return Object.keys(plan).length>0})),financingList=null==financingOption?void 0:financingOption.filter((function(plan){return Object.keys(plan).length>0})),finalData={title:(0,_utils__WEBPACK_IMPORTED_MODULE_5__.fp)((0,_utils__WEBPACK_IMPORTED_MODULE_5__.A$)(String(null==offerData?void 0:offerData.slug))),slug:null==offerData?void 0:offerData.slug,isTotallyFree:_isTotallyFree,details:null==offerData?void 0:offerData.details,expires_at:null==offerData?void 0:offerData.expires_at,show_modal:null==currentOffer?void 0:currentOffer.show_modal,pricing_exists:isNotTrial||financingOptionsExists,paymentOptions:paymentList,financingOptions:financingList,outOfConsumables,consumableOptions:[],bullets},resolve(finalData),null!=currentOffer&&currentOffer.show_modal&&!disableRedirects&&onOpenUpgrade(finalData),!1===(null==currentOffer?void 0:currentOffer.show_modal)&&offerData&&!disableRedirects&&router.push("/checkout?plan=".concat(null==offerData?void 0:offerData.slug)),_context3.next=35;break;case 34:resolve({status:"error-getting-plan-offer"});case 35:case"end":return _context3.stop()}}),_callee3)})));return function(_x3){return _ref5.apply(this,arguments)}}()).catch((function(){reject(),toast({position:"top",title:t("alert-message:error-getting-offer"),status:"error",duration:5e3,isClosable:!0})}))}))},reactivatePlan:function reactivatePlan(planSlug,planStatus){"CANCELLED"===planStatus&&(setPaymentStatus("idle"),router.push("/checkout?plan=".concat(planSlug)))},getSubscriptionDetails:function getSubscriptionDetails(sub){var _sub$status,_sub$invoices,_sub$currency,_sub$invoices$,status=null==sub||null===(_sub$status=sub.status)||void 0===_sub$status?void 0:_sub$status.toLowerCase(),isPlanFinancing="plan_financing"===(null==sub?void 0:sub.type),fullFilledInvoicesAmount=null==sub||null===(_sub$invoices=sub.invoices)||void 0===_sub$invoices?void 0:_sub$invoices.filter((function(invo){return"FULFILLED"===invo.status})).length,isPlanFinancingFullyPaid=fullFilledInvoicesAmount===(null==sub?void 0:sub.how_many_installments),nextPaymentDate=formatDate(null==sub?void 0:sub.next_payment_at),expirationDate=formatDate((null==sub?void 0:sub.plan_expires_at)||(null==sub?void 0:sub.next_payment_at)),activeSince=formatDate(null==sub?void 0:sub.created_at),subCurrency=_utils_variables__WEBPACK_IMPORTED_MODULE_6__.dB[null==sub||null===(_sub$currency=sub.currency)||void 0===_sub$currency?void 0:_sub$currency.code]||"$",invoiceAmount=null==sub||null===(_sub$invoices$=sub.invoices[0])||void 0===_sub$invoices$?void 0:_sub$invoices$.amount,monthlyPrice=null==sub?void 0:sub.monthly_price,totalPrice=(null==sub?void 0:sub.how_many_installments)*monthlyPrice,payEveryUnit=null==sub?void 0:sub.pay_every_unit,statusMessage=null==sub?void 0:sub.status_message,paymentText=function paymentText(amount,date){return t("subscription.next-payment-with-price",{amount,date,currencySymbol:subCurrency})},renewalDateText=function renewalDateText(date){return t("subscription.renewal-date",{date})},expirationDateText=function expirationDateText(date){return t("subscription.expiration-date",{date})},expiredOnText=function expiredOnText(date){return t("subscription.expired-on",{date})},activeSinceText=function activeSinceText(date){return t("subscription.active-since",{date})},totallyPaidText=function totallyPaidText(amount){return t("subscription.totally-paid",{amount,currencySymbol:subCurrency})},totalPaidText=function totalPaidText(paidAmount,pendingAmount){return t("subscription.total-paid",{paidAmount,pendingAmount,currencySymbol:subCurrency})},paymentInfoText=function paymentInfoText(amount,unit){return t("subscription.payment",{payment:"".concat(subCurrency).concat(amount,"/").concat(t("subscription.payment_unit_short.".concat(unit.toLowerCase())))})},errorMessageText=function errorMessageText(error){return t("subscription.error-message",{error:error||"Something went wrong"})},noPaymentsLeft=function noPaymentsLeft(){return t("subscription.no-payment-left")},statusConfig={active:function active(){return isPlanFinancing?{renewalDate:expirationDateText(expirationDate),paymentInfo:isPlanFinancingFullyPaid?totallyPaidText(fullFilledInvoicesAmount*monthlyPrice):totalPaidText(fullFilledInvoicesAmount*monthlyPrice,totalPrice),nextPayment:isPlanFinancingFullyPaid?noPaymentsLeft():paymentText(monthlyPrice,nextPaymentDate)}:{renewalDate:renewalDateText(nextPaymentDate),renewability:!!activeSince&&activeSinceText(activeSince),paymentInfo:0===invoiceAmount?t("subscription.payment",{payment:t("common:free")}):paymentInfoText(invoiceAmount,payEveryUnit)}},expired:function expired(){return{renewalDate:expiredOnText(expirationDate),paymentInfo:isPlanFinancing?totallyPaidText(fullFilledInvoicesAmount*monthlyPrice):paymentInfoText(invoiceAmount,payEveryUnit)}},error:function error(){return{errorMessage:errorMessageText(statusMessage),paymentInfo:invoiceAmount?paymentInfoText(invoiceAmount,payEveryUnit):"Error"}},payment_issue:function payment_issue(){return isPlanFinancing?{renewalDate:expirationDateText(expirationDate),nextPayment:isPlanFinancingFullyPaid?noPaymentsLeft():paymentText(monthlyPrice,nextPaymentDate),paymentInfo:isPlanFinancingFullyPaid?totallyPaidText(monthlyPrice):totalPaidText(fullFilledInvoicesAmount*monthlyPrice,totalPrice)}:{errorMessage:errorMessageText(statusMessage),paymentInfo:paymentInfoText(invoiceAmount,payEveryUnit)}},cancelled:function cancelled(){return isPlanFinancing?{renewalDate:expirationDateText(expirationDate),nextPayment:isPlanFinancingFullyPaid?noPaymentsLeft():paymentText(monthlyPrice,nextPaymentDate),paymentInfo:isPlanFinancingFullyPaid?totallyPaidText(monthlyPrice):totalPaidText(fullFilledInvoicesAmount*monthlyPrice,totalPrice)}:{paymentInfo:paymentInfoText(invoiceAmount,payEveryUnit)}},free_trial:function free_trial(){return{renewalDate:renewalDateText(nextPaymentDate),renewability:!!activeSince&&activeSinceText(activeSince),paymentInfo:t("subscription.payment",{payment:t("common:free")})}}};return statusConfig[status]?statusConfig[status]():{renewalDate:"",paymentInfo:"",nextPayment:"",errorMessage:"",renewability:""}}}}profileHandlers.propTypes={translations:prop_types__WEBPACK_IMPORTED_MODULE_14___default().objectOf(prop_types__WEBPACK_IMPORTED_MODULE_14___default().oneOfType([prop_types__WEBPACK_IMPORTED_MODULE_14___default().any]))},profileHandlers.defaultProps={translations:{}};const __WEBPACK_DEFAULT_EXPORT__=profileHandlers}}]);