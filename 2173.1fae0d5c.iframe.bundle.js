"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2173],{"./src/hooks/useSession.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>hooks_useSession});var react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),defineProperty=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),regenerator=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),regenerator_default=__webpack_require__.n(regenerator),next_router=__webpack_require__("./node_modules/next/router.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),utils=__webpack_require__("./src/utils/index.js"),axios=__webpack_require__("./node_modules/axios/lib/axios.js"),console=__webpack_require__("./node_modules/console-browserify/index.js");const hooks_useGoogleMaps=function useGoogleMaps(apiKey){var libraries=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"places",_useState=(0,react.useState)({loaded:!1,error:!1}),gmapStatus=_useState[0],setGmapStatus=_useState[1];(0,react.useEffect)(function(){if(window.google)setGmapStatus({loaded:!0,error:!1});else{var script=document.createElement("script");script.type="text/javascript",script.src="https://maps.google.com/maps/api/js?key=".concat(apiKey,"&libraries=").concat(libraries);var headScript=document.getElementsByTagName("script")[0];headScript.parentNode.insertBefore(script,headScript),script.addEventListener("load",function(){setGmapStatus({loaded:!0,error:!1})}),script.addEventListener("error",function(){setGmapStatus({loaded:!0,error:!0})})}},[apiKey,libraries]);var geocode=function geocode(request){if(utils.l6&&gmapStatus.loaded){var google=window.google,geocoder=new google.maps.Geocoder;return new Promise(function(resolve,reject){geocoder.geocode(request,function(result,geocodeStatus){geocodeStatus===google.maps.GeocoderStatus.OK?resolve(result):reject(result)})})}return null},geolocate=function(){var _ref=(0,asyncToGenerator.A)(regenerator_default().mark(function _callee(key){var result,_t;return regenerator_default().wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!gmapStatus.loaded||!key){_context.next=4;break}return _context.prev=1,_context.next=2,axios.A.post("https://www.googleapis.com/geolocation/v1/geolocate?key=".concat(key));case 2:return result=_context.sent,_context.abrupt("return",result);case 3:_context.prev=3,_t=_context.catch(1),console.error(_t);case 4:return _context.abrupt("return",null);case 5:case"end":return _context.stop()}},_callee,null,[[1,3]])}));return function geolocate(_x){return _ref.apply(this,arguments)}}(),getUserLocation=function(){var _ref2=(0,asyncToGenerator.A)(regenerator_default().mark(function _callee2(){var setCoords,userLocation,_yield$geolocate,data,loc,_args2=arguments;return regenerator_default().wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(setCoords=_args2.length>0&&void 0!==_args2[0]?_args2[0]:function(){},userLocation=localStorage.getItem("user-location"),!gmapStatus.loaded||!apiKey||userLocation){_context2.next=3;break}return _context2.next=1,geolocate(apiKey);case 1:return _yield$geolocate=_context2.sent,data=_yield$geolocate.data,loc={},data&&(setCoords({latitude:data.location.lat,longitude:data.location.lng}),loc.coordinates={latitude:data.location.lat,longitude:data.location.lng}),_context2.next=2,geocode({location:data.location});case 2:return _context2.sent[0].address_components.forEach(function(comp){comp.types.includes("locality")&&(loc.city=comp.long_name),comp.types.includes("country")&&(loc.country=comp.long_name,loc.countryShort=comp.short_name)}),localStorage.setItem("user-location",JSON.stringify(loc)),_context2.abrupt("return",loc);case 3:if(!userLocation){_context2.next=4;break}return _context2.abrupt("return",JSON.parse(userLocation));case 4:return _context2.abrupt("return",null);case 5:case"end":return _context2.stop()}},_callee2)}));return function getUserLocation(){return _ref2.apply(this,arguments)}}();return{gmapStatus,geocode,geolocate,getUserLocation}};var logging=__webpack_require__("./src/utils/logging.js"),process=__webpack_require__("./node_modules/process/browser.js"),__jsx=react.createElement;function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){(0,defineProperty.A)(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}var initialUserSession={utm_placement:"",utm_referrer:"",utm_medium:"",utm_source:"",utm_term:"",utm_content:"",utm_campaign:"",conversion_url:"",landing_url:"",user_agent:"",internal_cta_placement:"",internal_cta_content:"",internal_cta_campaign:"",ref:"",coupon:""},SessionContext=(0,react.createContext)({userSession:initialUserSession,location:null,isLoadingLocation:!0});function SessionProvider(_ref){var children=_ref.children,_useState=(0,react.useState)(initialUserSession),userSession=_useState[0],_setUserSession=_useState[1],router=(0,next_router.useRouter)(),_useState2=(0,react.useState)(null),location=_useState2[0],setLocation=_useState2[1],_useState3=(0,react.useState)(!0),isLoadingLocation=_useState3[0],setIsLoadingLocation=_useState3[1],GOOGLE_KEY=process.env.GOOGLE_GEO_KEY,_useGoogleMaps=hooks_useGoogleMaps(GOOGLE_KEY,"places"),gmapStatus=_useGoogleMaps.gmapStatus,getUserLocation=_useGoogleMaps.getUserLocation,initLocation=function(){var _ref2=(0,asyncToGenerator.A)(regenerator_default().mark(function _callee(){var loc,_t;return regenerator_default().wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=1,getUserLocation();case 1:loc=_context.sent,setLocation(loc),_context.next=3;break;case 2:_context.prev=2,_t=_context.catch(0),(0,logging.z3)("function getUserLocation()",_t);case 3:return _context.prev=3,setIsLoadingLocation(!1),_context.finish(3);case 4:case"end":return _context.stop()}},_callee,null,[[0,2,3,4]])}));return function initLocation(){return _ref2.apply(this,arguments)}}();(0,react.useEffect)(function(){initLocation()},[gmapStatus]);return(0,react.useEffect)(function(){!function handleUserSession(){if(utils.l6){var conversionUrl,storedSession=JSON.parse(localStorage.getItem("userSession")),userAgent=window.navigator.userAgent,landingUrl=null!=storedSession&&storedSession.landing_url&&""!==(null==storedSession?void 0:storedSession.landing_url)?null==storedSession?void 0:storedSession.landing_url:window.location.pathname;conversionUrl=["/checkout","/pricing"].some(function(path){return window.location.pathname.includes(path)})?null==storedSession?void 0:storedSession.conversion_url:window.location.pathname;var utm_placement=(0,utils.eA)("utm_placement")||(null==storedSession?void 0:storedSession.utm_placement),utm_referrer=(0,utils.eA)("utm_referrer")||(0,utils.eA)("utm_ref")||(0,utils.eA)("referrer")||(0,utils.eA)("ref")||(null==storedSession?void 0:storedSession.utm_referrer),utm_medium=(0,utils.eA)("utm_medium")||(null==storedSession?void 0:storedSession.utm_medium),utm_source=(0,utils.eA)("utm_source")||(null==storedSession?void 0:storedSession.utm_source),utm_term=(0,utils.eA)("utm_term")||(null==storedSession?void 0:storedSession.utm_term),utm_content=(0,utils.eA)("utm_content")||(null==storedSession?void 0:storedSession.utm_content),utm_campaign=(0,utils.eA)("utm_campaign")||(null==storedSession?void 0:storedSession.utm_campaign),internal_cta_placement=(0,utils.eA)("internal_cta_placement")||(null==storedSession?void 0:storedSession.internal_cta_placement),internal_cta_content=(0,utils.eA)("internal_cta_content")||(null==storedSession?void 0:storedSession.internal_cta_content),internal_cta_campaign=(0,utils.eA)("internal_cta_campaign")||(null==storedSession?void 0:storedSession.internal_cta_campaign),ref=(0,utils.eA)("ref")||(null==storedSession?void 0:storedSession.ref),coupon=(0,utils.eA)("coupon")||(null==storedSession?void 0:storedSession.coupon),cleanedStore=_objectSpread(_objectSpread({},storedSession),{},{translations:void 0}),session=_objectSpread(_objectSpread({},cleanedStore),{},{user_agent:userAgent,landing_url:landingUrl,conversion_url:conversionUrl,utm_placement,utm_referrer,utm_medium,utm_source,utm_term,utm_content,utm_campaign,internal_cta_placement,internal_cta_content,internal_cta_campaign,ref,coupon});_setUserSession(session),localStorage.setItem("userSession",JSON.stringify(session))}}()},[router]),__jsx(SessionContext.Provider,{value:{userSession,setUserSession:function setUserSession(session){localStorage.setItem("userSession",JSON.stringify(session)),_setUserSession(_objectSpread(_objectSpread({},userSession),session))},location,isLoadingLocation,setConversionUrl:function setConversionUrl(){if(utils.l6){if(["/checkout","/pricing"].some(function(path){return window.location.pathname.includes(path)}))return;var session=_objectSpread(_objectSpread({},userSession),{},{conversion_url:window.location.pathname});_setUserSession(session),localStorage.setItem("userSession",JSON.stringify(session))}}}},children)}SessionProvider.displayName="SessionProvider",SessionProvider.propTypes={children:prop_types_default().node},SessionProvider.defaultProps={children:null};SessionProvider.__docgenInfo={description:"",methods:[],displayName:"SessionProvider",props:{children:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"node"},required:!1}}};const hooks_useSession=function useSession(){return(0,react.useContext)(SessionContext)}},"./src/hooks/useSignup.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),_home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),_home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0__),react_redux__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-redux/es/index.js"),next_translate_useTranslation__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/next-translate/lib/esm/useTranslation.js"),next_router__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/next/router.js"),_store_actions_signupAction__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/store/actions/signupAction.js"),_services_breathecode__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/services/breathecode.js"),_utils__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/utils/index.js"),_utils_variables__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./src/utils/variables.js"),_utils_requests__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./src/utils/requests.js"),_usePersistent__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./src/hooks/usePersistent.js"),_useSession__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./src/hooks/useSession.js"),_useAuth__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./src/hooks/useAuth.js"),_useCustomToast__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./src/hooks/useCustomToast.jsx"),process=__webpack_require__("./node_modules/process/browser.js"),console=__webpack_require__("./node_modules/console-browserify/index.js"),_excluded=["service_items"];function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){(0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_1__.A)(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}const __WEBPACK_DEFAULT_EXPORT__=function useSignup(){var isAuthenticated=(0,_useAuth__WEBPACK_IMPORTED_MODULE_12__.A)().isAuthenticated,_useSession=(0,_useSession__WEBPACK_IMPORTED_MODULE_11__.A)(),userSession=_useSession.userSession,location=_useSession.location,state=(0,react_redux__WEBPACK_IMPORTED_MODULE_2__.d4)(function(sl){return sl.signupReducer}),_signupAction=(0,_store_actions_signupAction__WEBPACK_IMPORTED_MODULE_5__.A)(),setLoader=_signupAction.setLoader,setCheckingData=_signupAction.setCheckingData,setPaymentMethods=_signupAction.setPaymentMethods,toggleIfEnrolled=_signupAction.toggleIfEnrolled,setService=_signupAction.setService,setSelfAppliedCoupon=_signupAction.setSelfAppliedCoupon,setPaymentStatus=_signupAction.setPaymentStatus,setIsSubmittingPayment=_signupAction.setIsSubmittingPayment,setDeclinedPayment=_signupAction.setDeclinedPayment,_usePersistent=(0,_usePersistent__WEBPACK_IMPORTED_MODULE_10__.L)("subscription-process",null),setSubscriptionProcess=(0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_14__.A)(_usePersistent,2)[1],t=(0,next_translate_useTranslation__WEBPACK_IMPORTED_MODULE_3__.A)("signup").t,createToast=(0,_useCustomToast__WEBPACK_IMPORTED_MODULE_13__.A)({toastId:"error-payment-transaction"}).createToast,router=(0,next_router__WEBPACK_IMPORTED_MODULE_4__.useRouter)(),locale=router.locale,redirect=(0,_utils__WEBPACK_IMPORTED_MODULE_7__.$E)("redirect"),redirectedFrom=(0,_utils__WEBPACK_IMPORTED_MODULE_7__.$E)("redirected-from"),couponsQuery=(0,_utils__WEBPACK_IMPORTED_MODULE_7__.eA)("coupons"),defaultPlan=process.env.BASE_PLAN||"basic",country_code=null==location?void 0:location.countryShort,subscriptionStatusDictionary={PREPARING_FOR_COHORT:"PREPARING_FOR_COHORT"},nextMonthText=(0,_utils__WEBPACK_IMPORTED_MODULE_7__.AU)(1).translation[locale],stepIndex=state.stepIndex,checkingData=state.checkingData,planData=state.planData,selectedPlan=state.selectedPlan,paymentStatus=state.paymentStatus,isSubmittingPayment=state.isSubmittingPayment,isPaymentIdle="idle"===paymentStatus,stepsEnum={CONTACT:1,PAYMENT:2,SUMMARY:3},isFirstStep=stepIndex===stepsEnum.CONTACT,isSecondStep=stepIndex===stepsEnum.PAYMENT,isThirdStep=stepIndex===stepsEnum.SUMMARY,translations={one_payment:t("signup:one_payment"),free_trial:t("signup:free_trial"),monthly_payment:t("signup:monthly_payment"),quarterly_payment:t("signup:quarterly_payment"),half_yearly_payment:t("signup:half_yearly_payment"),yearly_payment:t("signup:yearly_payment"),free:t("signup:free"),totally_free:t("signup:totally_free"),free_trial_period:function free_trial_period(qty,period){var periodValue=null==period?void 0:period.toLowerCase(),singularTranslation={day:t("common:word-connector.day"),week:t("common:word-connector.week"),month:t("common:word-connector.month"),year:t("common:word-connector.year")},pluralTranslation={day:t("common:word-connector.days"),week:t("common:word-connector.weeks"),month:t("common:word-connector.months"),year:t("common:word-connector.years")};return t("signup:info.free-trial-period",{qty,period:qty>1?pluralTranslation[periodValue]:singularTranslation[periodValue]})},one_payment_description:t("signup:one_payment_description"),monthly_payment_description:t("signup:monthly_payment_description"),quarterly_payment_description:t("signup:quarterly_payment_description"),half_yearly_payment_description:t("signup:half_yearly_payment_description"),yearly_payment_description:t("signup:yearly_payment_description"),checkout_featured_info:function checkout_featured_info(planSlug){return t("signup:custom-plans-pricing.".concat(planSlug,".checkout_features"),{},{returnObjects:!0})},financing_description:function financing_description(price,months,currency){return t("signup:financing_many_months_description",{monthly_price:price,many_months:months,currency})},monthly:t("signup:info.monthly"),quarterly:t("signup:info.quarterly"),half_yearly:t("signup:info.half-yearly"),yearly:t("signup:info.yearly"),financing:t("signup:info.financing"),many_months_payment:function many_months_payment(qty){return t("signup:many_months_payment",{qty})}},processPlans=function(){var _ref=(0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_15__.A)(_home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee(data){var _ref2,_ref2$monthly,monthly,_ref2$quarterly,quarterly,_ref2$halfYearly,halfYearly,_ref2$yearly,yearly,_ref2$planType,planType,_data$financing_optio,_data$plans,_data$plans2,_data$financing_optio2,_data$financing_optio3,_singlePlan$currency,_data$currency,_data$currency2,_data$currency3,_data$currency4,_data$currency5,_data$currency6,slug,resp,featuredInfo,owner,existsAmountPerHalf,existsAmountPerMonth,existsAmountPerQuarter,existsAmountPerYear,hasPayaBleSuscription,financingOptionsExists,singlePlan,isTotallyFree,hasSubscriptionMethod,financingOptions,financingOptionsOnePayment,relevantInfo,textInfo,trialPlanDescription,onePaymentFinancing,trialPlan,monthPlan,quarterPlan,halfPlan,yearPlan,financingOption,planList,paymentList,financingList,_t,_args=arguments;return _home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _ref2$monthly=(_ref2=_args.length>1&&void 0!==_args[1]?_args[1]:{}).monthly,monthly=void 0===_ref2$monthly||_ref2$monthly,_ref2$quarterly=_ref2.quarterly,quarterly=void 0===_ref2$quarterly||_ref2$quarterly,_ref2$halfYearly=_ref2.halfYearly,halfYearly=void 0===_ref2$halfYearly||_ref2$halfYearly,_ref2$yearly=_ref2.yearly,yearly=void 0===_ref2$yearly||_ref2$yearly,_ref2$planType=_ref2.planType,planType=void 0===_ref2$planType?"":_ref2$planType,_context.prev=1,slug=encodeURIComponent(null==data?void 0:data.slug),_context.next=2,_services_breathecode__WEBPACK_IMPORTED_MODULE_6__.A.payment({country_code}).getServiceItemsByPlan(slug);case 2:if(resp=_context.sent){_context.next=3;break}throw new Error("The plan does not exist");case 3:return featuredInfo=Array.isArray(translations.checkout_featured_info(null==data?void 0:data.slug))?translations.checkout_featured_info(null==data?void 0:data.slug):null==resp?void 0:resp.data,owner=null==data?void 0:data.owner,existsAmountPerHalf=(null==data?void 0:data.price_per_half)>0,existsAmountPerMonth=(null==data?void 0:data.price_per_month)>0,existsAmountPerQuarter=(null==data?void 0:data.price_per_quarter)>0,existsAmountPerYear=(null==data?void 0:data.price_per_year)>0,hasPayaBleSuscription=existsAmountPerHalf||existsAmountPerMonth||existsAmountPerQuarter||existsAmountPerYear,financingOptionsExists=(null==data||null===(_data$financing_optio=data.financing_options)||void 0===_data$financing_optio?void 0:_data$financing_optio.length)>0,singlePlan=(null==data||null===(_data$plans=data.plans)||void 0===_data$plans?void 0:_data$plans.length)>0?null==data||null===(_data$plans2=data.plans)||void 0===_data$plans2?void 0:_data$plans2[0]:data,isTotallyFree=!hasPayaBleSuscription&&0===(null==singlePlan?void 0:singlePlan.trial_duration)&&!financingOptionsExists,hasSubscriptionMethod=hasPayaBleSuscription||isTotallyFree||(null==singlePlan?void 0:singlePlan.trial_duration_unit)>0,financingOptions=(null==data||null===(_data$financing_optio2=data.financing_options)||void 0===_data$financing_optio2?void 0:_data$financing_optio2.filter(function(l){return l.monthly_price>0&&l.how_many_months>1}).sort(function(a,b){return a.monthly_price-b.monthly_price}))||[],financingOptionsOnePayment=(null==data||null===(_data$financing_optio3=data.financing_options)||void 0===_data$financing_optio3?void 0:_data$financing_optio3.filter(function(l){return(null==l?void 0:l.monthly_price)>0&&1===(null==l?void 0:l.how_many_months)}))||[],relevantInfo={plan_slug:null==singlePlan?void 0:singlePlan.slug,currency:null==singlePlan?void 0:singlePlan.currency,featured_info:featuredInfo,trial_duration:(null==singlePlan?void 0:singlePlan.trial_duration)||0,trial_duration_unit:(null==singlePlan?void 0:singlePlan.trial_duration_unit)||"",planType,show:!0,isFreeTier:!1,owner},textInfo={free:(null==translations?void 0:translations.free)||"Free",totally_free:(null==translations?void 0:translations.totally_free)||"Totally free",free_trial:(null==translations?void 0:translations.free_trial)||"Free trial",one_payment:(null==translations?void 0:translations.one_payment)||"One payment",monthly_payment:(null==translations?void 0:translations.monthly_payment)||"Monthly payment",quarterly_payment:(null==translations?void 0:translations.quarterly_payment)||"Quarterly payment",half_yearly_payment:(null==translations?void 0:translations.half_yearly_payment)||"Half yearly payment",yearly_payment:(null==translations?void 0:translations.yearly_payment)||"Yearly payment",many_months_payment:function many_months_payment(qty){return(null==translations?void 0:translations.many_months_payment(qty))||"Payment for ".concat(qty," months")},label:{free_trial_period:function free_trial_period(qty,period){var periodToLowerCase=null==period?void 0:period.toLowerCase();return(null==translations?void 0:translations.free_trial_period(qty,periodToLowerCase))||"Free trial for ".concat(qty," ").concat(periodToLowerCase)},free:(null==translations?void 0:translations.free)||"Free",monthly:(null==translations?void 0:translations.monthly)||"Monthly",quarterly:(null==translations?void 0:translations.quarterly)||"Quarterly",half_yearly:(null==translations?void 0:translations.half_yearly)||"Half yearly",yearly:(null==translations?void 0:translations.yearly)||"Yearly",financing:(null==translations?void 0:translations.financing)||"Financing"}},trialPlanDescription=isTotallyFree?textInfo.totally_free:textInfo.label.free_trial_period(null==singlePlan?void 0:singlePlan.trial_duration,null==singlePlan?void 0:singlePlan.trial_duration_unit),onePaymentFinancing=financingOptionsOnePayment.map(function(item){var _item$currency;return _objectSpread(_objectSpread({},relevantInfo),{},{title:textInfo.one_payment,price:null==item?void 0:item.monthly_price,priceText:"".concat(_utils_variables__WEBPACK_IMPORTED_MODULE_8__.tV[null==item||null===(_item$currency=item.currency)||void 0===_item$currency?void 0:_item$currency.code]||"$").concat(null==item?void 0:item.monthly_price),period:"ONE_TIME",period_label:textInfo.one_payment,plan_id:"f-".concat(null==item?void 0:item.monthly_price,"-").concat(null==item?void 0:item.how_many_months),description:(null==translations?void 0:translations.one_payment_description)||"",how_many_months:null==item?void 0:item.how_many_months,type:"PAYMENT"})}),trialPlan=financingOptionsExists||hasPayaBleSuscription?{}:_objectSpread(_objectSpread({},relevantInfo),{},{title:null!=singlePlan&&singlePlan.title?null==singlePlan?void 0:singlePlan.title:(0,_utils__WEBPACK_IMPORTED_MODULE_7__.fY)(String(null==singlePlan?void 0:singlePlan.slug)),price:0,priceText:isTotallyFree?textInfo.free:textInfo.free_trial,plan_id:"p-".concat(null==singlePlan?void 0:singlePlan.trial_duration,"-trial"),description:trialPlanDescription,period:isTotallyFree?"FREE":null==singlePlan?void 0:singlePlan.trial_duration_unit,period_label:trialPlanDescription,type:isTotallyFree?"FREE":"TRIAL",isFreeTier:!0}),monthPlan=monthly&&existsAmountPerMonth?_objectSpread(_objectSpread({},relevantInfo),{},{title:null!=singlePlan&&singlePlan.title?null==singlePlan?void 0:singlePlan.title:textInfo.monthly_payment,price:null==data?void 0:data.price_per_month,pricePerMonth:null==data?void 0:data.price_per_month,priceText:"".concat(_utils_variables__WEBPACK_IMPORTED_MODULE_8__.tV[null==singlePlan||null===(_singlePlan$currency=singlePlan.currency)||void 0===_singlePlan$currency?void 0:_singlePlan$currency.code]||"$").concat(null==data?void 0:data.price_per_month),plan_id:"p-".concat(null==data?void 0:data.price_per_month),description:(null==translations?void 0:translations.yearly_payment_description)||"",period:"MONTH",period_label:textInfo.label.monthly,type:"PAYMENT"}):{},quarterPlan=quarterly&&existsAmountPerQuarter?_objectSpread(_objectSpread({},relevantInfo),{},{title:null!=singlePlan&&singlePlan.title?null==singlePlan?void 0:singlePlan.title:textInfo.quarterly_payment,price:null==data?void 0:data.price_per_quarter,pricePerMonth:null!=data&&data.price_per_quarter?(data.price_per_quarter/4).toFixed(2):0,pricePerMonthText:"".concat(_utils_variables__WEBPACK_IMPORTED_MODULE_8__.tV[null==data||null===(_data$currency=data.currency)||void 0===_data$currency?void 0:_data$currency.code]||"$").concat(null!=data&&data.price_per_quarter?(data.price_per_quarter/4).toFixed(2):0),priceText:"".concat(_utils_variables__WEBPACK_IMPORTED_MODULE_8__.tV[null==data||null===(_data$currency2=data.currency)||void 0===_data$currency2?void 0:_data$currency2.code]||"$").concat((null==data?void 0:data.price_per_quarter)||0),plan_id:"p-".concat((null==data?void 0:data.price_per_quarter)||0),description:(null==translations?void 0:translations.quarterly_payment_description)||"",period:"QUARTER",period_label:textInfo.label.quarterly,type:"PAYMENT",show:!1}):{},halfPlan=halfYearly&&existsAmountPerHalf?_objectSpread(_objectSpread({},relevantInfo),{},{title:null!=singlePlan&&singlePlan.title?null==singlePlan?void 0:singlePlan.title:textInfo.half_yearly_payment,price:null==data?void 0:data.price_per_half,pricePerMonth:null!=data&&data.price_per_half?(data.price_per_half/6).toFixed(2):0,pricePerMonthText:"".concat(_utils_variables__WEBPACK_IMPORTED_MODULE_8__.tV[null==data||null===(_data$currency3=data.currency)||void 0===_data$currency3?void 0:_data$currency3.code]||"$").concat(null!=data&&data.price_per_half?(data.price_per_half/6).toFixed(2):0),priceText:"".concat(_utils_variables__WEBPACK_IMPORTED_MODULE_8__.tV[null==data||null===(_data$currency4=data.currency)||void 0===_data$currency4?void 0:_data$currency4.code]||"$").concat((null==data?void 0:data.price_per_half)||0),plan_id:"p-".concat((null==data?void 0:data.price_per_half)||0),description:(null==translations?void 0:translations.half_yearly_payment_description)||"",period:"HALF",period_label:textInfo.label.half_yearly,type:"PAYMENT",show:!1}):{},yearPlan=yearly&&existsAmountPerYear?_objectSpread(_objectSpread({},relevantInfo),{},{title:null!=singlePlan&&singlePlan.title?null==singlePlan?void 0:singlePlan.title:textInfo.yearly_payment,price:null==data?void 0:data.price_per_year,pricePerMonth:null!=data&&data.price_per_year?(data.price_per_year/12).toFixed(2):0,pricePerMonthText:"".concat(_utils_variables__WEBPACK_IMPORTED_MODULE_8__.tV[null==data||null===(_data$currency5=data.currency)||void 0===_data$currency5?void 0:_data$currency5.code]||"$").concat(null!=data&&data.price_per_year?(data.price_per_year/12).toFixed(2):0),priceText:"".concat(_utils_variables__WEBPACK_IMPORTED_MODULE_8__.tV[null==data||null===(_data$currency6=data.currency)||void 0===_data$currency6?void 0:_data$currency6.code]||"$").concat((null==data?void 0:data.price_per_year)||0),plan_id:"p-".concat((null==data?void 0:data.price_per_year)||0),description:(null==translations?void 0:translations.yearly_payment_description)||"",period:"YEAR",period_label:textInfo.label.yearly,type:"PAYMENT"}):{},financingOption=financingOptions.map(function(item,index){var _item$currency2,_item$currency3,financingTitle=translations.many_months_payment(null==item?void 0:item.how_many_months),financingOptionsDescription=null==translations?void 0:translations.financing_description(null==item?void 0:item.monthly_price,null==item?void 0:item.how_many_months,_utils_variables__WEBPACK_IMPORTED_MODULE_8__.tV[null==item||null===(_item$currency2=item.currency)||void 0===_item$currency2?void 0:_item$currency2.code]||"$");return _objectSpread(_objectSpread({},relevantInfo),{},{financingId:index+1,title:null!=singlePlan&&singlePlan.title?null==singlePlan?void 0:singlePlan.title:financingTitle,price:null==item?void 0:item.monthly_price,priceText:"".concat(_utils_variables__WEBPACK_IMPORTED_MODULE_8__.tV[null==item||null===(_item$currency3=item.currency)||void 0===_item$currency3?void 0:_item$currency3.code]||"$").concat(null==item?void 0:item.monthly_price," x ").concat(null==item?void 0:item.how_many_months),plan_id:"f-".concat(null==item?void 0:item.monthly_price,"-").concat(null==item?void 0:item.how_many_months),description:financingOptionsDescription||"",period:"FINANCING",period_label:textInfo.label.financing,how_many_months:null==item?void 0:item.how_many_months,type:"PAYMENT"})}),planList=[trialPlan,onePaymentFinancing[0],yearPlan,halfPlan,quarterPlan,monthPlan].concat((0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_16__.A)(financingOption)).filter(function(plan){return plan&&Object.keys(plan).length>0&&plan.show}),paymentList=[onePaymentFinancing[0],yearPlan,monthPlan,trialPlan].filter(function(plan){return plan&&Object.keys(plan).length>0}),financingList=null==financingOption?void 0:financingOption.filter(function(plan){return plan&&Object.keys(plan).length>0}),_context.abrupt("return",_objectSpread(_objectSpread({},data),{},{title:(null==data?void 0:data.title)||(0,_utils__WEBPACK_IMPORTED_MODULE_7__.rS)(null==data?void 0:data.slug),isTotallyFree,isTrial:!hasPayaBleSuscription&&!financingOptionsExists,plans:planList,featured_info:featuredInfo||[],paymentOptions:paymentList,financingOptions:financingList,hasSubscriptionMethod}));case 4:return _context.prev=4,_t=_context.catch(1),console.error("Error processing plans:",_t),_context.abrupt("return",_t);case 5:case"end":return _context.stop()}},_callee,null,[[1,4]])}));return function processPlans(_x){return _ref.apply(this,arguments)}}(),generatePlan=function(){var _ref3=(0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_15__.A)(_home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee2(planSlug){var resp,data,_t2;return _home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.prev=0,_context2.next=1,_services_breathecode__WEBPACK_IMPORTED_MODULE_6__.A.payment({country_code}).getPlan(planSlug);case 1:return resp=_context2.sent,_context2.next=2,processPlans(null==resp?void 0:resp.data);case 2:return data=_context2.sent,console.log(data),_context2.abrupt("return",data);case 3:return _context2.prev=3,_t2=_context2.catch(0),console.error("Error generating plan:",_t2),_context2.abrupt("return",{});case 4:case"end":return _context2.stop()}},_callee2,null,[[0,3]])}));return function generatePlan(_x2){return _ref3.apply(this,arguments)}}(),getSuggestedPlan=function(){var _ref4=(0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_15__.A)(_home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee3(slug){var ignoreProcessPlans,_yield$bc$payment$pla,data,planComparison,_planComparison$detai,originalPlan,suggestedPlan,dataForOriginPlan,dataForSuggestedPlan,_err$response,_t3,_t4,_t5,_args3=arguments;return _home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return ignoreProcessPlans=_args3.length>1&&void 0!==_args3[1]&&_args3[1],_context3.prev=1,_context3.next=2,_services_breathecode__WEBPACK_IMPORTED_MODULE_6__.A.payment({original_plan:slug,country_code}).planOffer();case 2:if(_yield$bc$payment$pla=_context3.sent,0!==(null==(data=_yield$bc$payment$pla.data)?void 0:data.length)){_context3.next=3;break}return _context3.abrupt("return",null);case 3:if(planComparison=data[0],ignoreProcessPlans){_context3.next=10;break}if(originalPlan=null==planComparison?void 0:planComparison.original_plan,suggestedPlan=null==planComparison?void 0:planComparison.suggested_plan,!originalPlan.slug){_context3.next=5;break}return _context3.next=4,processPlans(originalPlan,{quarterly:!1,halfYearly:!1,planType:"original"});case 4:_t3=_context3.sent,_context3.next=6;break;case 5:_t3={};case 6:if(dataForOriginPlan=_t3,!suggestedPlan.slug){_context3.next=8;break}return _context3.next=7,processPlans(suggestedPlan,{quarterly:!1,halfYearly:!1,planType:"suggested"},translations);case 7:_t4=_context3.sent,_context3.next=9;break;case 8:_t4={};case 9:return dataForSuggestedPlan=_t4,_context3.abrupt("return",{plans:{original_plan:_objectSpread(_objectSpread({},dataForOriginPlan),{},{originData:originalPlan}),suggested_plan:_objectSpread(_objectSpread({},dataForSuggestedPlan),{},{originData:suggestedPlan})},details:null==planComparison?void 0:planComparison.details,title:null==planComparison||null===(_planComparison$detai=planComparison.details)||void 0===_planComparison$detai?void 0:_planComparison$detai.title});case 10:return _context3.abrupt("return",planComparison);case 11:return _context3.prev=11,_t5=_context3.catch(1),_context3.abrupt("return",null==_t5||null===(_err$response=_t5.response)||void 0===_err$response?void 0:_err$response.data);case 12:case"end":return _context3.stop()}},_callee3,null,[[1,11]])}));return function getSuggestedPlan(_x3){return _ref4.apply(this,arguments)}}(),handleSuggestedPlan=function(){var _ref5=(0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_15__.A)(_home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee4(planSlug){var version,_suggestedPlanData$pl5,_suggestedPlanData$pl6,suggestedPlanData,_suggestedPlanData$pl,_suggestedPlanData$pl2,originalPlanData,_suggestedPlanData$pl3,_suggestedPlanData$pl4,_originalPlanData,originalPlanProps,suggestedPlanProps,originalPlan,suggestedPlan,formatedPlanData,_t6,_args4=arguments;return _home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return version=_args4.length>1&&void 0!==_args4[1]?_args4[1]:"default",_context4.prev=1,_context4.next=2,getSuggestedPlan(planSlug);case 2:if(suggestedPlanData=_context4.sent,"default"!==version){_context4.next=5;break}if(suggestedPlanData&&0!==suggestedPlanData.length){_context4.next=4;break}return _context4.next=3,generatePlan(planSlug);case 3:return originalPlanData=_context4.sent,_context4.abrupt("return",{plans:{original_plan:originalPlanData,suggested_plan:{}},details:{},title:(null==originalPlanData?void 0:originalPlanData.title)||"",planList:(0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_16__.A)((null==originalPlanData?void 0:originalPlanData.plans)||[])});case 4:return _context4.abrupt("return",_objectSpread(_objectSpread({},suggestedPlanData),{},{planList:[].concat((0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_16__.A)((null==suggestedPlanData||null===(_suggestedPlanData$pl=suggestedPlanData.plans)||void 0===_suggestedPlanData$pl||null===(_suggestedPlanData$pl=_suggestedPlanData$pl.original_plan)||void 0===_suggestedPlanData$pl?void 0:_suggestedPlanData$pl.plans)||[]),(0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_16__.A)((null==suggestedPlanData||null===(_suggestedPlanData$pl2=suggestedPlanData.plans)||void 0===_suggestedPlanData$pl2||null===(_suggestedPlanData$pl2=_suggestedPlanData$pl2.suggested_plan)||void 0===_suggestedPlanData$pl2?void 0:_suggestedPlanData$pl2.plans)||[]))}));case 5:if("mkt_plans"!==version){_context4.next=8;break}if(suggestedPlanData&&0!==suggestedPlanData.length){_context4.next=7;break}return _context4.next=6,generatePlan(planSlug);case 6:return _originalPlanData=_context4.sent,_context4.abrupt("return",_objectSpread(_objectSpread({},_originalPlanData),{},{planList:(null==_originalPlanData?void 0:_originalPlanData.plans)||[],plans:{original_plan:_originalPlanData,suggested_plan:{}},details:{},title:(null==_originalPlanData?void 0:_originalPlanData.title)||""}));case 7:return originalPlanProps=(null===(_suggestedPlanData$pl3=suggestedPlanData.plans)||void 0===_suggestedPlanData$pl3?void 0:_suggestedPlanData$pl3.original_plan)||{},suggestedPlanProps=(null===(_suggestedPlanData$pl4=suggestedPlanData.plans)||void 0===_suggestedPlanData$pl4?void 0:_suggestedPlanData$pl4.suggested_plan)||{},originalPlan=(null==originalPlanProps?void 0:originalPlanProps.plans)||[],suggestedPlan=(null==suggestedPlanProps?void 0:suggestedPlanProps.plans)||[],formatedPlanData={planList:[].concat((0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_16__.A)(originalPlan),(0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_16__.A)(suggestedPlan)),plans:{original_plan:originalPlanProps,suggested_plan:suggestedPlanProps},slug:(null==suggestedPlanProps?void 0:suggestedPlanProps.slug)||originalPlanProps.slug||"",financingOptions:[].concat((0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_16__.A)((null==originalPlanProps?void 0:originalPlanProps.financingOptions)||[]),(0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_16__.A)((null==suggestedPlanProps?void 0:suggestedPlanProps.financingOptions)||[])),paymentOptions:[].concat((0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_16__.A)((null==originalPlanProps?void 0:originalPlanProps.paymentOptions)||[]),(0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_16__.A)((null==suggestedPlanProps?void 0:suggestedPlanProps.paymentOptions)||[]))},_context4.abrupt("return",formatedPlanData);case 8:return _context4.abrupt("return",_objectSpread(_objectSpread({},suggestedPlanData),{},{planList:[].concat((0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_16__.A)((null==suggestedPlanData||null===(_suggestedPlanData$pl5=suggestedPlanData.plans)||void 0===_suggestedPlanData$pl5||null===(_suggestedPlanData$pl5=_suggestedPlanData$pl5.original_plan)||void 0===_suggestedPlanData$pl5?void 0:_suggestedPlanData$pl5.plans)||[]),(0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_16__.A)((null==suggestedPlanData||null===(_suggestedPlanData$pl6=suggestedPlanData.plans)||void 0===_suggestedPlanData$pl6||null===(_suggestedPlanData$pl6=_suggestedPlanData$pl6.suggested_plan)||void 0===_suggestedPlanData$pl6?void 0:_suggestedPlanData$pl6.plans)||[]))}));case 9:return _context4.prev=9,_t6=_context4.catch(1),console.error(_t6),_context4.abrupt("return",{});case 10:case"end":return _context4.stop()}},_callee4,null,[[1,9]])}));return function handleSuggestedPlan(_x4){return _ref5.apply(this,arguments)}}(),validatePlanExistence=function(){var _ref6=(0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_15__.A)(_home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee5(subscriptions){var planSlug,planComparison,basePlan,suggestedPlan,hasBasePlan,hasASuggestedPlan,_args5=arguments;return _home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return planSlug=(_args5.length>1&&void 0!==_args5[1]?_args5[1]:"")||_utils_variables__WEBPACK_IMPORTED_MODULE_8__.Y_,_context5.prev=1,_context5.next=2,getSuggestedPlan(planSlug,!0);case 2:return planComparison=_context5.sent,basePlan=null==planComparison?void 0:planComparison.original_plan,suggestedPlan=null==planComparison?void 0:planComparison.suggested_plan,hasBasePlan=subscriptions.some(function(s){var _s$plans;return(null==s||null===(_s$plans=s.plans)||void 0===_s$plans||null===(_s$plans=_s$plans[0])||void 0===_s$plans?void 0:_s$plans.slug)===(null==basePlan?void 0:basePlan.slug)}),hasASuggestedPlan=subscriptions.some(function(s){var _s$plans2;return(null==s||null===(_s$plans2=s.plans)||void 0===_s$plans2||null===(_s$plans2=_s$plans2[0])||void 0===_s$plans2?void 0:_s$plans2.slug)===(null==suggestedPlan?void 0:suggestedPlan.slug)}),_context5.abrupt("return",{basePlan,suggestedPlan,hasBasePlan,hasASuggestedPlan,allSubscriptions:subscriptions});case 3:return _context5.prev=3,_context5.catch(1),_context5.abrupt("return",{basePlan:{},suggestedPlan:{},hasBasePlan:!1,hasASuggestedPlan:!1,allSubscriptions:subscriptions});case 4:case"end":return _context5.stop()}},_callee5,null,[[1,3]])}));return function validatePlanExistence(_x5){return _ref6.apply(this,arguments)}}(),handlePayment=function(){var _ref7=(0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_15__.A)(_home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee6(data){var disableRedirects,manyInstallmentsExists,isTtrial,getRequests,_couponData$data,requests,response,transactionData,_transactionData$plan,currency,simplePlans,_planData$currency,restOfPlan,couponData,_t8,_args6=arguments;return _home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return disableRedirects=_args6.length>1&&void 0!==_args6[1]&&_args6[1],manyInstallmentsExists=(null==selectedPlan?void 0:selectedPlan.how_many_months)>0||"FINANCING"===(null==selectedPlan?void 0:selectedPlan.period),isTtrial=["FREE","TRIAL"].includes(null==selectedPlan?void 0:selectedPlan.type),getRequests=function getRequests(){return isTtrial?{type:(null==data?void 0:data.type)||(null==checkingData?void 0:checkingData.type),token:(null==data?void 0:data.token)||(null==checkingData?void 0:checkingData.token)}:{type:(null==data?void 0:data.type)||(null==checkingData?void 0:checkingData.type),token:(null==data?void 0:data.token)||(null==checkingData?void 0:checkingData.token),how_many_installments:(null==data?void 0:data.installments)||(null==selectedPlan?void 0:selectedPlan.how_many_months)||void 0,chosen_period:manyInstallmentsExists?void 0:(null==selectedPlan?void 0:selectedPlan.period)||"HALF",coupons:null==checkingData?void 0:checkingData.coupons}},_context6.prev=1,requests=getRequests(),_context6.next=2,_services_breathecode__WEBPACK_IMPORTED_MODULE_6__.A.payment().pay(_objectSpread(_objectSpread({country_code},requests),{},{conversion_info:_objectSpread({},userSession)}));case 2:return response=_context6.sent,"FULFILLED"===(null==(transactionData=response.data)?void 0:transactionData.status)&&(setSubscriptionProcess({status:subscriptionStatusDictionary.PREPARING_FOR_COHORT}),currency="USD",simplePlans=[],planData&&(null!=planData&&null!==(_planData$currency=planData.currency)&&void 0!==_planData$currency&&_planData$currency.code&&(currency=planData.currency.code),planData.service_items,restOfPlan=(0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties_js__WEBPACK_IMPORTED_MODULE_17__.A)(planData,_excluded),simplePlans=[{plan:restOfPlan}]),(0,_utils_requests__WEBPACK_IMPORTED_MODULE_9__.A$)({dataLayer:{event:"purchase",value:(null==selectedPlan?void 0:selectedPlan.price)||0,currency,payment_type:"Credit card",plan:(null==selectedPlan?void 0:selectedPlan.plan_slug)||(null==transactionData||null===(_transactionData$plan=transactionData.plan)||void 0===_transactionData$plan?void 0:_transactionData$plan.slug)||defaultPlan,period_label:(null==selectedPlan?void 0:selectedPlan.period_label)||"one-time",items:simplePlans,agent:(0,_utils__WEBPACK_IMPORTED_MODULE_7__.VK)()}}),disableRedirects||(redirect&&(null==redirect?void 0:redirect.length)>0||redirectedFrom&&redirectedFrom.length>0?(router.push(redirect||redirectedFrom),localStorage.removeItem("redirect"),localStorage.removeItem("redirected-from")):router.push("/choose-program")),(void 0===transactionData||transactionData.status>=400)&&createToast({position:"top",title:t("alert-message:payment-error"),status:"error",duration:7e3,isClosable:!0})),_context6.next=3,_services_breathecode__WEBPACK_IMPORTED_MODULE_6__.A.payment().getMyCoupon();case 3:return(null==(couponData=_context6.sent)||null===(_couponData$data=couponData.data)||void 0===_couponData$data?void 0:_couponData$data.length)>0&&(0,_utils_requests__WEBPACK_IMPORTED_MODULE_9__.A$)({dataLayer:{event:"plan_coupon_create",coupon_data:null==couponData?void 0:couponData.data[0]}}),_context6.abrupt("return",transactionData);case 4:return _context6.prev=4,_t8=_context6.catch(1),console.error("Error handling payment bc.payment().pay",_t8),_context6.abrupt("return",_t8);case 5:case"end":return _context6.stop()}},_callee6,null,[[1,4]])}));return function handlePayment(_x6){return _ref7.apply(this,arguments)}}(),getChecking=function(){var _ref8=(0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_15__.A)(_home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee7(plansData){var checkingBody,_data$plans3,response,data,currentPlan,planSlug,finalData,result,_t9;return _home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return checkingBody={type:"PREVIEW",plans:[null==plansData?void 0:plansData.slug],coupons:couponsQuery?[couponsQuery]:void 0,country_code},_context7.prev=1,_context7.next=2,_services_breathecode__WEBPACK_IMPORTED_MODULE_6__.A.payment().checking(checkingBody);case 2:return response=_context7.sent,data=response.data,currentPlan=null==data||null===(_data$plans3=data.plans)||void 0===_data$plans3?void 0:_data$plans3[0],planSlug=encodeURIComponent(null==currentPlan?void 0:currentPlan.slug),_context7.next=3,generatePlan(planSlug);case 3:if(delete(finalData=_context7.sent).id,!(response.status<400)){_context7.next=4;break}return result=_objectSpread(_objectSpread({},data),finalData),setCheckingData(result),_context7.abrupt("return",result);case 4:return _context7.abrupt("return",response);case 5:return _context7.prev=5,400===(null==(_t9=_context7.catch(1))?void 0:_t9.status)?toggleIfEnrolled(!0):console.err(_t9),_context7.abrupt("return",_t9);case 6:case"end":return _context7.stop()}},_callee7,null,[[1,5]])}));return function getChecking(_x7){return _ref8.apply(this,arguments)}}(),getPaymentMethods=function(){var _ref9=(0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_15__.A)(_home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee8(ownerId){var resp,_t0;return _home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:if(_context8.prev=0,!isAuthenticated){_context8.next=2;break}return setLoader("paymentMethods",!1),setLoader("paymentMethods",!0),_context8.next=1,_services_breathecode__WEBPACK_IMPORTED_MODULE_6__.A.payment({academy_id:ownerId,lang:router.locale,country_code}).getpaymentMethods();case 1:(resp=_context8.sent).status<400&&setPaymentMethods(resp.data),setLoader("paymentMethods",!1);case 2:_context8.next=4;break;case 3:_context8.prev=3,_t0=_context8.catch(0),console.log(_t0),setLoader("paymentMethods",!1);case 4:case"end":return _context8.stop()}},_callee8,null,[[0,3]])}));return function getPaymentMethods(_x8){return _ref9.apply(this,arguments)}}(),getPriceWithDiscount=function getPriceWithDiscount(price,couponData){var discount=null==couponData?void 0:couponData.discount_value,discountType=null==couponData?void 0:couponData.discount_type;if(discount){if("PERCENT_OFF"===discountType||"HAGGLING"===discountType)return{originalPrice:price,price:Math.round(100*(price-price*discount+Number.EPSILON))/100,discount:"".concat(100*discount,"%"),discountType};if("FIXED_PRICE"===discountType)return{originalPrice:price,price:price-discount,discount:"$".concat(discount),discountType}}return{price,discount:"0%"}},getSelfAppliedCoupon=function(){var _ref0=(0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_15__.A)(_home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee9(plan){var _yield$bc$payment$ver,data,coupon,_t1;return _home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:if(_context9.prev=0,!plan){_context9.next=2;break}return _context9.next=1,_services_breathecode__WEBPACK_IMPORTED_MODULE_6__.A.payment({plan,country_code}).verifyCoupon();case 1:_yield$bc$payment$ver=_context9.sent,data=_yield$bc$payment$ver.data,(coupon=data[0])&&setSelfAppliedCoupon(_objectSpread(_objectSpread({},coupon),{},{plan}));case 2:_context9.next=4;break;case 3:_context9.prev=3,_t1=_context9.catch(0),console.log(_t1);case 4:case"end":return _context9.stop()}},_callee9,null,[[0,3]])}));return function getSelfAppliedCoupon(_x9){return _ref0.apply(this,arguments)}}(),handleSubscribeToPlan=function(){var _ref10=(0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_15__.A)(_home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee0(_ref1){var slug,_ref1$onSubscribedToP,onSubscribedToPlan,_ref1$disableRedirect,disableRedirects,data,respData,respPayment,_t10;return _home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context0){for(;;)switch(_context0.prev=_context0.next){case 0:return slug=_ref1.slug,_ref1$onSubscribedToP=_ref1.onSubscribedToPlan,onSubscribedToPlan=void 0===_ref1$onSubscribedToP?function(){}:_ref1$onSubscribedToP,_ref1$disableRedirect=_ref1.disableRedirects,disableRedirects=void 0!==_ref1$disableRedirect&&_ref1$disableRedirect,_context0.prev=1,_context0.next=2,generatePlan(slug);case 2:return data=_context0.sent,onSubscribedToPlan(data),_context0.next=3,getChecking(data);case 3:return respData=_context0.sent,_context0.next=4,handlePayment(_objectSpread(_objectSpread({},respData),{},{installments:null==respData?void 0:respData.how_many_months}),disableRedirects);case 4:return respPayment=_context0.sent,_context0.abrupt("return",respPayment);case 5:return _context0.prev=5,_t10=_context0.catch(1),console.error("Error handling subscribe to plan",_t10),createToast({position:"top",title:t("alert-message:payment-error"),status:"error",duration:7e3,isClosable:!0}),_context0.abrupt("return",_t10);case 6:case"end":return _context0.stop()}},_callee0,null,[[1,5]])}));return function handleSubscribeToPlan(_x0){return _ref10.apply(this,arguments)}}(),subscribeFreePlan=function(){var _ref11=(0,_home_runner_work_app_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_15__.A)(_home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee1(checking){var respPayment,silentCode;return _home_runner_work_app_app_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context1){for(;;)switch(_context1.prev=_context1.next){case 0:if(isPaymentIdle&&!isSubmittingPayment&&null!=selectedPlan&&selectedPlan.plan_id){_context1.next=1;break}return _context1.abrupt("return");case 1:return setIsSubmittingPayment(!0),_context1.prev=2,_context1.next=3,handlePayment(_objectSpread(_objectSpread({},checking),{},{installments:null==selectedPlan?void 0:selectedPlan.how_many_months}),!0);case 3:(null==(respPayment=_context1.sent)?void 0:respPayment.status_code)>=400&&(setPaymentStatus("error"),console.log("wililililili",null==respPayment?void 0:respPayment.detail),setDeclinedPayment({title:t("transaction-denied"),description:(null==respPayment?void 0:respPayment.detail)||t("payment-not-processed")})),(silentCode=null==respPayment?void 0:respPayment.silent_code)&&(silentCode===_utils_variables__WEBPACK_IMPORTED_MODULE_8__.y4.CARD_ERROR&&(setPaymentStatus("error"),setDeclinedPayment({title:t("transaction-denied"),description:t("card-declined")})),_utils_variables__WEBPACK_IMPORTED_MODULE_8__.y4.LIST_PROCESSING_ERRORS.includes(silentCode)&&(setPaymentStatus("error"),setDeclinedPayment({title:t("transaction-denied"),description:t("payment-not-processed")})),silentCode===_utils_variables__WEBPACK_IMPORTED_MODULE_8__.y4.UNEXPECTED_EXCEPTION&&(setPaymentStatus("error"),setDeclinedPayment({title:t("transaction-denied"),description:t("payment-error")}))),"FULFILLED"===respPayment.status&&setPaymentStatus("success"),setIsSubmittingPayment(!1),setLoader("plan",!1),_context1.next=5;break;case 4:_context1.prev=4,_context1.catch(2),setLoader("plan",!1),createToast({position:"top",title:t("alert-message:payment-error"),status:"error",duration:7e3,isClosable:!0});case 5:case"end":return _context1.stop()}},_callee1,null,[[2,4]])}));return function subscribeFreePlan(_x1){return _ref11.apply(this,arguments)}}();return{state,stepsEnum,isFirstStep,isSecondStep,isThirdStep,handlePayment,getChecking,getPaymentText:function getPaymentText(){var planIsNotTrial="TRIAL"!==(null==selectedPlan?void 0:selectedPlan.type),period=null==selectedPlan?void 0:selectedPlan.period;if(planIsNotTrial){var _selectedPlan$financi,_selectedPlan$financi2,_selectedPlan$financi3,_selectedPlan$financi8,_selectedPlan$financi9,_selectedPlan$financi0,_selectedPlan$financi13,_selectedPlan$financi14,_selectedPlan$financi15,_selectedPlan$financi16;if("FINANCING"===period){var totalAmount=(null==selectedPlan?void 0:selectedPlan.price)*(null==selectedPlan?void 0:selectedPlan.how_many_months);return t("info.will-pay-month",{price:null==selectedPlan?void 0:selectedPlan.price,qty_months:null==selectedPlan?void 0:selectedPlan.how_many_months,total_amount:Math.round(100*totalAmount)/100})}if((null==selectedPlan||null===(_selectedPlan$financi=selectedPlan.financing_options)||void 0===_selectedPlan$financi?void 0:_selectedPlan$financi.length)>0&&(null==selectedPlan||null===(_selectedPlan$financi2=selectedPlan.financing_options[0])||void 0===_selectedPlan$financi2?void 0:_selectedPlan$financi2.monthly_price)>0&&1===(null==selectedPlan||null===(_selectedPlan$financi3=selectedPlan.financing_options[0])||void 0===_selectedPlan$financi3?void 0:_selectedPlan$financi3.how_many_months)){var _selectedPlan$financi4,_selectedPlan$financi5,_selectedPlan$financi6,_selectedPlan$financi7,_totalAmount=(null==selectedPlan||null===(_selectedPlan$financi4=selectedPlan.financing_options[0])||void 0===_selectedPlan$financi4?void 0:_selectedPlan$financi4.monthly_price)*(null==selectedPlan||null===(_selectedPlan$financi5=selectedPlan.financing_options[0])||void 0===_selectedPlan$financi5?void 0:_selectedPlan$financi5.how_many_months);return t("info.will-pay-month",{price:null==selectedPlan||null===(_selectedPlan$financi6=selectedPlan.financing_options[0])||void 0===_selectedPlan$financi6?void 0:_selectedPlan$financi6.monthly_price,qty_months:null==selectedPlan||null===(_selectedPlan$financi7=selectedPlan.financing_options[0])||void 0===_selectedPlan$financi7?void 0:_selectedPlan$financi7.how_many_months,total_amount:Math.round(100*_totalAmount)/100})}if((null==selectedPlan||null===(_selectedPlan$financi8=selectedPlan.financing_options)||void 0===_selectedPlan$financi8?void 0:_selectedPlan$financi8.length)>0&&(null==selectedPlan||null===(_selectedPlan$financi9=selectedPlan.financing_options[0])||void 0===_selectedPlan$financi9?void 0:_selectedPlan$financi9.monthly_price)>0&&(null==selectedPlan||null===(_selectedPlan$financi0=selectedPlan.financing_options[0])||void 0===_selectedPlan$financi0?void 0:_selectedPlan$financi0.how_many_months)>0){var _selectedPlan$financi1,_selectedPlan$financi10,_selectedPlan$financi11,_selectedPlan$financi12,_totalAmount2=(null==selectedPlan||null===(_selectedPlan$financi1=selectedPlan.financing_options[0])||void 0===_selectedPlan$financi1?void 0:_selectedPlan$financi1.monthly_price)*(null==selectedPlan||null===(_selectedPlan$financi10=selectedPlan.financing_options[0])||void 0===_selectedPlan$financi10?void 0:_selectedPlan$financi10.how_many_months);return t("info.will-pay-monthly",{price:null==selectedPlan||null===(_selectedPlan$financi11=selectedPlan.financing_options[0])||void 0===_selectedPlan$financi11?void 0:_selectedPlan$financi11.monthly_price,qty_months:null==selectedPlan||null===(_selectedPlan$financi12=selectedPlan.financing_options[0])||void 0===_selectedPlan$financi12?void 0:_selectedPlan$financi12.how_many_months,total_amount:Math.round(100*_totalAmount2)/100,next_month:nextMonthText})}if((null==selectedPlan||null===(_selectedPlan$financi13=selectedPlan.financing_options)||void 0===_selectedPlan$financi13?void 0:_selectedPlan$financi13.length)>0&&(null==selectedPlan||null===(_selectedPlan$financi14=selectedPlan.financing_options[0])||void 0===_selectedPlan$financi14?void 0:_selectedPlan$financi14.monthly_price)>0&&0===(null==selectedPlan||null===(_selectedPlan$financi15=selectedPlan.financing_options[0])||void 0===_selectedPlan$financi15?void 0:_selectedPlan$financi15.how_many_months))return t("info.will-pay-now",{price:null==selectedPlan||null===(_selectedPlan$financi16=selectedPlan.financing_options[0])||void 0===_selectedPlan$financi16?void 0:_selectedPlan$financi16.monthly_price});var periodPayments={MONTH:t("info.will-pay-per-month",{price:null==selectedPlan?void 0:selectedPlan.price}),QUARTER:t("info.will-pay-per-quarter",{price:null==selectedPlan?void 0:selectedPlan.price}),HALF:t("info.will-pay-per-half-year",{price:null==selectedPlan?void 0:selectedPlan.price}),YEAR:t("info.will-pay-per-year",{price:null==selectedPlan?void 0:selectedPlan.price}),ONE_TIME:t("info.one-time-connector",{value:null==selectedPlan?void 0:selectedPlan.price})};if(periodPayments[period])return periodPayments[period]}return""},handleServiceToConsume:function handleServiceToConsume(data){for(var discountRatio=null==data?void 0:data.discount_ratio,bundleSize=null==data?void 0:data.bundle_size,pricePerUnit=null==data?void 0:data.price_per_unit,maxItems=null==data?void 0:data.max_items,maxNumItems=Math.floor(maxItems/bundleSize),allItems=[],consumableTypes={mentorship:"mentorship sessions",event:"events",compilation:"compilations"},num=1;num<=maxNumItems;num+=1){var numItems=num*bundleSize;if(numItems%bundleSize===0){var _data$serviceInfo,_data$serviceInfo2,price=(0,_utils__WEBPACK_IMPORTED_MODULE_7__.EE)({numItems,maxItems,discountRatio,bundleSize,pricePerUnit,startDiscountFrom:1});allItems.push({id:num,slug:"".concat(numItems,"-").concat(null==data||null===(_data$serviceInfo=data.serviceInfo)||void 0===_data$serviceInfo?void 0:_data$serviceInfo.type),title:"".concat(numItems," ").concat(consumableTypes[null==data||null===(_data$serviceInfo2=data.serviceInfo)||void 0===_data$serviceInfo2?void 0:_data$serviceInfo2.type]),qty:numItems,pricePerUnit:price.discounted/numItems,price:price.original,priceText:(0,_utils__WEBPACK_IMPORTED_MODULE_7__.$g)(price.discounted,!0),priceDiscounted:price.discounted,type:"CONSUMABLE"})}}setService(_objectSpread(_objectSpread({},data),{},{list:allItems}))},getPaymentMethods,getPriceWithDiscount,getSelfAppliedCoupon,applyDiscountCouponsToPlans:function applyDiscountCouponsToPlans(pricingList,coupon){return coupon?pricingList.map(function(item){var price=item.price;if(price<1)return item;var discountOperation=getPriceWithDiscount(price,coupon);return _objectSpread(_objectSpread({},item),{},{price:discountOperation.price,priceText:item.priceText.replace(item.price,discountOperation.price),lastPrice:item.priceText})}):pricingList},subscriptionStatusDictionary,handleSubscribeToPlan,processPlans,handleSuggestedPlan,validatePlanExistence,subscribeFreePlan,reactivatePlan:function reactivatePlan(planSlug,planStatus){"CANCELLED"===planStatus&&(setPaymentStatus("idle"),router.push("/checkout?plan=".concat(planSlug)))},generatePlan}}}}]);